version: 2
models:
  - name: core__fact_balances

    columns:
      - name: BLOCK_DATE
        tests:
          - not_null:
              where: block_date > current_date - 3

      - name: ADDRESS
        description: '{{ doc("address") }}'
        tests:
          - not_null:
              where: block_date > current_date - 3

      - name: TOKEN_ADDRESS
        description: '{{ doc("token_address") }}'
        tests:
          - not_null:
              where: block_date > current_date - 3

      - name: BALANCE_UNADJ
        tests:
          - not_null:
              where: block_date > current_date - 3

      - name: BALANCE

      - name: SYMBOL
        description: '{{ doc("symbol") }}'

      - name: NAME
        description: '{{ doc("name") }}'

      - name: DECIMALS
        description: '{{ doc("decimals") }}'

      - name: TOKEN_IS_VERIFIED
        tests:
          - not_null:
              where: block_date > current_date - 3

      - name: FROZEN
        tests:
          - not_null:
              where: block_date > current_date - 3

      - name: FACT_BALANCES_ID
        description: '{{ doc("pk") }}'
        tests:
          - unique:
              where: block_date > current_date - 3
          - not_null:
              where: block_date > current_date - 3

      - name: INSERTED_TIMESTAMP
        description: '{{ doc("inserted_timestamp") }}'

      - name: MODIFIED_TIMESTAMP
        description: '{{ doc("modified_timestamp") }}'

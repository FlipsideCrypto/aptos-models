version: 2

models:
  - name: silver__fungible_asset_transfers
    description: |
      Tracks all fungible asset transfers (deposits and withdrawals).
      Joins with store owners and metadata to provide complete transfer information.
      The model processes data from March 2025 and maintains incremental updates.
    
    columns:
      - name: block_number
        description: Block number when the transfer occurred
        tests:
          - not_null

      - name: block_timestamp
        description: Timestamp of the block when the transfer occurred
        tests:
          - not_null

      - name: block_date
        description: Date of the block when the transfer occurred
        tests:
          - not_null

      - name: tx_hash
        description: Transaction hash of the transfer
        tests:
          - not_null

      - name: version
        description: Version of the transaction
        tests:
          - not_null

      - name: success
        description: Whether the transfer was successful
        tests:
          - not_null

      - name: event_index
        description: Index of the event within the transaction
        tests:
          - not_null

      - name: transfer_event
        description: Type of transfer event (Deposit/Withdraw)
        tests:
          - not_null
          - accepted_values:
              values: ['WithdrawEvent', 'DepositEvent', 'Withdraw', 'Deposit']

      - name: store_address
        description: Address of the fungible store involved in the transfer
        tests:
          - not_null

      - name: direction
        description: Direction of the transfer (Deposit/Withdraw)
        tests:
          - not_null
          - accepted_values:
              values: ['Deposit', 'Withdraw']

      - name: amount
        description: Amount of tokens transferred
        tests:
          - not_null

      - name: owner_address
        description: Address of the store owner at time of transfer
        tests:
          - not_null

      - name: metadata_address
        description: Address of the token metadata
        tests:
          - not_null

      - name: transactions_id
        description: Unique identifier for the transaction (surrogate key)
        tests:
          - not_null

      - name: transfers_id
        description: Unique identifier for the transfer (surrogate key)
        tests:
          - not_null
          - unique

      - name: inserted_timestamp
        description: Timestamp of when this record was inserted (computed)
        tests:
          - not_null

      - name: modified_timestamp
        description: Timestamp of when this record was last modified
        tests:
          - not_null

      - name: _invocation_id
        description: Unique identifier for the dbt run that inserted this record
        tests:
          - not_null 